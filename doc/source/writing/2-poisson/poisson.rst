Poisson Equation
==============================

Introduction
------------------------------

Consider the Poisson equation 

.. math::
   :label: poisson

   \nabla^2 \phi = s

in Domain :math:`\Omega` with appropriate boundary conditions on :math:`\partial \Omega`.

where,
:math:`s` is a source function.

Grid for Discretization
-------------------------------


Taylor Polynomial
-------------------------------

A Taylor polynomial of order k, generated by :math:`f(x)` at :math:`x=a` is given by:

.. math::
    P_k(x)=f(a)+f^{\prime}(a)(x-a)+\frac{f^{\prime \prime}(a)}{2 !}(x-a)^2+\ldots+\frac{f^{(k)}(a)}{k !}(x-a)^k

Therefore, we can generate :math:`\Phi_k(x)` by :math:`\phi_(x_i)`

.. math::
    \Phi_k(x)=\phi(x_i)+\phi^{\prime}(x_i)(x-x_i)+\frac{\phi^{\prime \prime}(x_i)}{2 !}(x-x_i)^2+\ldots+\frac{\phi^{(k)}(x_i)}{k !}(x-x_i)^k


:math:`\Phi_k(x)` proximates :math:`\phi(x)` at :math:`x = x_{i+1}`,

.. math::
     \phi(x_{i+1}) &\approx \Phi_k(x_{i+1})\\
      &=\phi(x_i) +\phi^{\prime}(x_i)(x_{i+1}-x_i) \\
         &+\frac{\phi^{\prime \prime}(x_i)}{2 !}(x_{i+1}-x_i)^2
         +\ldots
         +\frac{\phi^{(k)}(x_i)}{k !}(x_{i+1}-x_i)^k
    
where, :math:`h = x_{i+1}-x_i` in a uniform grid. 

.. math::
     \phi(x_{i+1}) &\approx \Phi_k(x_{i+1})\\
      &=\phi(x_i) +\phi^{\prime}(x_i) h 
         +\frac{\phi^{\prime \prime}(x_i)}{2}h^2
         +\frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^3 + \ldots

:math:`\Phi_k(x_{i-1})` obtained in the same way.

.. math::
     \phi(x_{i-1}) &\approx \Phi_k(x_{i-1})\\
      &=\phi(x_i) - \phi^{\prime}(x_i) h 
         +\frac{\phi^{\prime \prime}(x_i)}{2}h^2
         -\frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^3 + \ldots

derivatives on cell face, :math:`\frac{d \phi}{d x}_{x + \frac{1}{2}}`, can be obtained by,

.. math::
    \frac{\partial \phi}{\partial x}_{i + \frac{1}{2}} & \approx 
    (\Phi_k(x_{i+1}) - \Phi_k(x_i)) / h \\
    & = \phi^{\prime}(x_i)
        +\frac{\phi^{\prime \prime}(x_i)}{2}h
        +\frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^2 + \ldots

.. math::
    \frac{\partial \phi}{\partial x}|_{i - \frac{1}{2}} & \approx
    (\Phi_k(x_{i}) - \Phi_k(x_{i-1})) / h \\
    &= \phi^{\prime}(x_i) 
       - \frac{\phi^{\prime \prime}(x_i)}{2}h
       + \frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^2 + \ldots

Therefore,

.. math::
   :label: p2 

    \frac{\partial^2 \phi}{\partial x^2}_{i} & \approx
    (\Phi_k(x_{i+1}) - \Phi_k(x_i) - \Phi_k(x_i) + \Phi_k(x_{i-1})) / h^2 \\
    &= (\phi^{\prime}(x_i)
       + \frac{\phi^{\prime \prime}(x_i)}{2}h
       + \frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^2
       - \phi^{\prime}(x_i) 
       + \frac{\phi^{\prime \prime}(x_i)}{2}h
       - \frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^2 + \ldots) / h \\
    &= (\phi^{(2)}(x_i) h + 2 \frac{\phi^{(4)}(x_i)}{4!} h^3 + \ldots) / h \\
    &= \phi^{(2)}(x_i)  + O(h^2) \\
    &= \phi^{(2)}(x_i)  + \frac{\phi^{(4)}(x_i)}{12} h^2 + O(h^4) \\
    &= \phi^{(2)}(x_i)  + \frac{h^2}{12} \phi^{(4)}(x_i) + \frac{h^4}{360} \phi^{(6)}(x_i) + O(h^6)

Let us introduce the operator 

.. math::
   :label: delta2 

   \delta^2_x \phi = \frac{\Phi(x_{i+1}) - \Phi(x_i) - \Phi(x_i) + \Phi(x_{i-1})}{h^2}



Similar partial derivative of :math:`\phi` at grid point :math:`ijk` in y- and z- directions.

.. math::
    \frac{\partial^2 \phi}{\partial x^2}_{ijk} \approx 
     \phi^{(2)}_{ijk} + \frac{h^2}{12} \phi^{(4)}(x_i) + \frac{h^4}{360} \phi^{(6)}(x_i)\ldots


2-Order Scheme
-------------------------------



Finite Difference Scheme
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.. math::

    \frac{\partial \psi}{\partial x_d} \long \mathbf{i}+\frac{1}{2} \mathbf{e}^d

Finite Volume Scheme
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. math::

   \frac{1}{h} \sum_{d=0}^3\left(\left\langle\frac{\partial \phi}{\partial x_d}
   \right\rangle_{\mathbf{i}+\frac{1}{2} \mathbf{e}^d}-\left\langle\frac{\partial \phi}{\partial x_d}
   \right\rangle_{\mathbf{i}-\frac{1}{2} \mathbf{e}^d}\right)
    = \langle f\rangle_{\mathbf{i}}

.. math::
   :label: fvs 
   
   \frac{1}{h} \sum_{d=0}^3\left[\left\langle\frac{\partial \phi}{\partial x_d}\right\rangle\right]_{\mathbf{i}
   -\frac{1}{2} \mathbf{e}^d}^{\mathbf{i}+\frac{1}{2} \mathbf{e}^d}
    = \langle f\rangle_{\mathbf{i}}

向量的定义
+++++++++++++++++