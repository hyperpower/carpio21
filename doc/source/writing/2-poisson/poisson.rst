Poisson Equation
==============================

Introduction
------------------------------

Consider the Poisson equation 

.. math::
   :label: poisson

   \nabla^2 \phi = f

in Domain :math:`\Omega` with appropriate boundary conditions on :math:`\partial \Omega`.

where,
:math:`f` is a source function.

Grid for Discretization
-------------------------------


Taylor Polynomial
-------------------------------

A Taylor polynomial of order k, generated by :math:`f(x)` at :math:`x=a` is given by:

.. math::
    P_k(x)=f(a)+f^{\prime}(a)(x-a)+\frac{f^{\prime \prime}(a)}{2 !}(x-a)^2+\ldots+\frac{f^{(k)}(a)}{k !}(x-a)^k

Similarly, we can generate a polynomial :math:`\Phi_k(x)` to proximate function :math:`\phi` in :eq:`poisson` at :math:`x = x_{i}`.

.. math::
    :label: phi_taylor

    \Phi_k(x)=\phi(x_i)
             &+\phi^{\prime}(x_i)(x-x_i)
             +\frac{\phi^{\prime \prime}(x_i)}{2 !}(x-x_i)^2 \\
             &+\ldots+\frac{\phi^{(k)}(x_i)}{k !}(x-x_i)^k

:math:`\phi(x_{i+1})` can be obtained by :eq:`phi_taylor`, 

.. math::
     \phi(x_{i+1}) &\approx \Phi_k(x_{i+1})\\
      &=\phi(x_i) +\phi^{\prime}(x_i)(x_{i+1}-x_i) \\
         &+\frac{\phi^{\prime \prime}(x_i)}{2 !}(x_{i+1}-x_i)^2
         +\ldots
         +\frac{\phi^{(k)}(x_i)}{k !}(x_{i+1}-x_i)^k
    
where, :math:`h = x_{i+1}-x_i` in a uniform grid. Thus,

.. math::
     \phi(x_{i+1}) &\approx \Phi_k(x_{i+1})\\
         &=\phi(x_i) +\phi^{\prime}(x_i) h 
         +\frac{\phi^{\prime \prime}(x_i)}{2}h^2
         +\frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^3 + \ldots

:math:`\phi_(x_{i-1})` can be obtained in the same way.

.. math::
     \phi(x_{i-1}) &\approx \Phi_k(x_{i-1})\\
      &=\phi(x_i) - \phi^{\prime}(x_i) h 
         +\frac{\phi^{\prime \prime}(x_i)}{2}h^2
         -\frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^3 + \ldots

derivatives on cell face, :math:`\frac{\partial \phi}{\partial x}\mid _{i + \frac{1}{2}}`, can be obtained by,

.. math::
    \frac{\partial \phi}{\partial x}\mid_{i + \frac{1}{2}} & \approx 
    (\Phi_k(x_{i+1}) - \Phi_k(x_i)) / h \\
    & = \phi^{\prime}(x_i)
        +\frac{\phi^{\prime \prime}(x_i)}{2}h
        +\frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^2 + \ldots

.. math::
    \frac{\partial \phi}{\partial x}\mid_{i - \frac{1}{2}} & \approx
    (\Phi_k(x_{i}) - \Phi_k(x_{i-1})) / h \\
    &= \phi^{\prime}(x_i) 
       - \frac{\phi^{\prime \prime}(x_i)}{2}h
       + \frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^2 + \ldots

Therefore,

.. math::
   :label: p2 

    \frac{\partial^2 \phi}{\partial x^2}\mid_{i} & \approx
    (\Phi_k(x_{i+1}) - \Phi_k(x_i) - \Phi_k(x_i) + \Phi_k(x_{i-1})) / h^2 \\
    &= (\phi^{\prime}(x_i)
       + \frac{\phi^{\prime \prime}(x_i)}{2}h
       + \frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^2
       - \phi^{\prime}(x_i) 
       + \frac{\phi^{\prime \prime}(x_i)}{2}h
       - \frac{\phi^{\prime \prime \prime}(x_i)}{3 !}h^2 + \ldots) / h \\
    &= (\phi^{(2)}(x_i) h + 2 \frac{\phi^{(4)}(x_i)}{4!} h^3 + \ldots) / h \\
    &= \phi^{(2)}(x_i)  + O(h^2) \\
    &= \phi^{(2)}(x_i)  + \frac{\phi^{(4)}(x_i)}{12} h^2 + O(h^4) \\
    &= \phi^{(2)}(x_i)  + \frac{h^2}{12} \phi^{(4)}(x_i) + \frac{h^4}{360} \phi^{(6)}(x_i) + O(h^6)

Let us introduce the operator :math:`\delta^2_x \phi` , which represents the central difference approximation to the second partial derivative of :math:`\phi` in the x-direction at grid point ijk corresponding to :math:`(x_i, y_j, z_k)`.

.. math::
   :label: delta2x 

    \frac{\partial^2 \phi}{\partial x^2} \mid _{ijk} = \delta^2_x \phi_{ijk} + O(h^2)


Similar partial derivative of :math:`\phi` at grid point :math:`ijk` in y- and z- directions.

.. math::
   :label: delta2y 

    \frac{\partial^2 \phi}{\partial y^2} \mid _{ijk} = \delta^2_y \phi_{ijk} + O(h^2)

.. math::
   :label: delta2z

    \frac{\partial^2 \phi}{\partial z^2} \mid _{ijk} = \delta^2_z \phi_{ijk} + O(h^2)

Rewrite :eq:`delta2x` to :eq:`delta2z` include high order term in :eq:`p2`

.. math::
   :label: deltahx 

    \frac{\partial^2 \phi}{\partial x^2} \mid _{ijk} 
    = \delta^2_x \phi_{ijk} 
    + \frac{h^2}{12} \frac{\partial^4 \phi}{\partial x^4}_{ijk} 
    + \frac{h^4}{360} \frac{\partial^6 \phi}{\partial x^6}_{ijk}  + \ldots 

.. math::
   :label: deltahy 

    \frac{\partial^2 \phi}{\partial y^2} \mid _{ijk} = 
    \delta^2_y \phi_{ijk}  
    + \frac{h^2}{12} \frac{\partial^4 \phi}{\partial y^4}_{ijk} 
    + \frac{h^4}{360} \frac{\partial^6 \phi}{\partial y^6}_{ijk}  + \ldots 

.. math::
   :label: deltahz

    \frac{\partial^2 \phi}{\partial z^2} \mid _{ijk} = 
    \delta^2_z \phi_{ijk}  
    + \frac{h^2}{12} \frac{\partial^4 \phi}{\partial z^4}_{ijk} 
    + \frac{h^4}{360} \frac{\partial^6 \phi}{\partial z^6}_{ijk}  + \ldots 


Rewrite :eq:`poisson` into,

.. math::
    :label: poisson2

    \frac{\partial^2 \phi}{\partial x^2} + 
    \frac{\partial^2 \phi}{\partial y^2} + 
    \frac{\partial^2 \phi}{\partial z^2} = f

Substituting :eq:`deltahx` - :eq:`deltahz` into :eq:`poisson2`, we obtain the alternative form of :eq:`poisson2` including high order term.

.. math::
   :label: poissonh 

    \delta^2_x \phi_{ijk} &+ \delta^2_y \phi_{ijk} + \delta^2_z \phi_{ijk} \\ 
    &+ \frac{h^2}{12} (\frac{\partial^4 \phi}{\partial x^4}_{ijk} 
    +\frac{\partial^4 \phi}{\partial y^4}_{ijk} 
    +\frac{\partial^4 \phi}{\partial z^4}_{ijk})\\
    &+ \frac{h^4}{360} (\frac{\partial^6 \phi}{\partial x^6}_{ijk} 
    + \frac{\partial^6 \phi}{\partial y^6}_{ijk} 
    + \frac{\partial^6 \phi}{\partial z^6}_{ijk}) + O(h^6) \\
    &= f_{ijk} 

Define :math:`\tau_{ijk}` as truncation error in :eq:`poissonh`

.. math::
   :label: truncatione

    \tau_{ijk} &= \frac{h^2}{12} (\frac{\partial^4 \phi}{\partial x^4}_{ijk} 
    +\frac{\partial^4 \phi}{\partial y^4}_{ijk} 
    +\frac{\partial^4 \phi}{\partial z^4}_{ijk})\\
    &+ \frac{h^4}{360} (\frac{\partial^6 \phi}{\partial x^6}_{ijk} 
    + \frac{\partial^6 \phi}{\partial y^6}_{ijk} 
    + \frac{\partial^6 \phi}{\partial z^6}_{ijk})  + O(h^6) \\


Take the appropriate derivative of :eq:`poisson2` to write

.. math::
    :label: poisson4x

    \frac{\partial^4 \phi}{\partial x^4} + 
    \frac{\partial^4 \phi}{\partial x^2 y^2} + 
    \frac{\partial^4 \phi}{\partial x^2 z^2} = 
    \frac{\partial^2 f}{\partial x^2}

.. math::
    :label: poisson4y

    \frac{\partial^4 \phi}{\partial x^2 y^2} + 
    \frac{\partial^4 \phi}{\partial y^4} + 
    \frac{\partial^4 \phi}{\partial z^2 y^2} = 
    \frac{\partial^2 f}{\partial y^2}

.. math::
    :label: poisson4z

    \frac{\partial^4 \phi}{\partial x^2 z^2} + 
    \frac{\partial^4 \phi}{\partial y^2 z^2} + 
    \frac{\partial^4 \phi}{\partial z^4} = 
    \frac{\partial^2 f}{\partial z^2}

Substituting :eq:`poisson4x` - :eq:`poisson4z` into :eq:`truncatione`,

.. math::
   :label: truncatione2

    \tau_{ijk} &= \frac{h^2}{12} 
    \left( \frac{\partial^2 f}{\partial x^2} 
     + \frac{\partial^2 f}{\partial y^2} 
     + \frac{\partial^2 f}{\partial z^2} \right) _{ijk} \\ 
    & - \frac{h^2}{6} \left(  
       \frac{\partial^4 \phi}{\partial x^2 y^2}
      +\frac{\partial^4 \phi}{\partial y^2 z^2}
      +\frac{\partial^4 \phi}{\partial z^2 x^2}\right)_{ijk}\\
    &+ \frac{h^4}{360} \left( 
        \frac{\partial^6 \phi}{\partial x^6} 
      + \frac{\partial^6 \phi}{\partial y^6} 
      + \frac{\partial^6 \phi}{\partial z^6} \right)_{ijk}  + O(h^6) \\


2-Order Scheme
-------------------------------



Finite Difference Scheme
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.. math::

    \frac{\partial \psi}{\partial x_d} \long \mathbf{i}+\frac{1}{2} \mathbf{e}^d

Finite Volume Scheme
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. math::

   \frac{1}{h} \sum_{d=0}^3\left(\left\langle\frac{\partial \phi}{\partial x_d}
   \right\rangle_{\mathbf{i}+\frac{1}{2} \mathbf{e}^d}-\left\langle\frac{\partial \phi}{\partial x_d}
   \right\rangle_{\mathbf{i}-\frac{1}{2} \mathbf{e}^d}\right)
    = \langle f\rangle_{\mathbf{i}}

.. math::
   :label: fvs 
   
   \frac{1}{h} \sum_{d=0}^3\left[\left\langle\frac{\partial \phi}{\partial x_d}\right\rangle\right]_{\mathbf{i}
   -\frac{1}{2} \mathbf{e}^d}^{\mathbf{i}+\frac{1}{2} \mathbf{e}^d}
    = \langle f\rangle_{\mathbf{i}}

向量的定义
+++++++++++++++++